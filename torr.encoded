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CiAgICAiZHJhbWEiID0+IGFycmF5KCAgICMgVFbcfMgNCiAgICAgICAgImh0dHBzOi8vdG9ycmVudHNpcjc2LmNvbS9iYnMvYm9hcmQucGhwP2JvX3RhYmxlPWRyYW1hJnNjYT0mc2ZsPXdyX3N1YmplY3Qmc29wPWFuZCZzdHg9e2t9IiwNCiAgICApLA0KICAgICJkb2N1IiA9PiBhcnJheSggICAgIyBUVuRQL9ysDQogICAgICAgICJodHRwczovL3RvcnJlbnRzaXI3Ni5jb20vYmJzL2JvYXJkLnBocD9ib190YWJsZT10diZzY2E9JnNmbD13cl9zdWJqZWN0JnNvcD1hbmQmc3R4PXtrfSINCiAgICApLA0KICAgICJtaWQiID0+IGFycmF5KCAgICAgIyB4bdx8yA0KICAgICAgICAvLyBUVtx8yNAg7GgNCiAgICApLA0KICAgICJldGMiID0+IGFycmF5KCAgICAgIyCk7CAsIGDIIPENCiAgICAgICAgImh0dHBzOi8vdG9ycmVudHNpcjc2LmNvbS9iYnMvYm9hcmQucGhwP2JvX3RhYmxlPWFuaSZzY2E9JnNmbD13cl9zdWJqZWN0JnNvcD1hbmQmc3R4PXtrfSINCiAgICApLCANCg0KICAgICMgjNwQRCDAFVjAIEpAIL2wIIDJYCCM3BAgqV0NCiAgICAiYWxsIiA9PiBhcnJheSgiZW50IiwgImRyYW1hIiwgImRvY3UiKSwNCg0KICAgICMgAKldLCDktFzcIMFsIIDJRCAEXCAV3N0gKDQuICjAvZA6IHMt6HwgfHg8XCCYrCwgbS3s7CB8eDxcIJisLCBpLQCMOJAgNNwpDQogICAgIl9wYWdlX2xpbmtfcHJlcHJvY2VzcyIgPT4gYXJyYXkoKSwNCiAgICAiX3BhZ2VfbGluayIgPT4gJyE8ZGl2IGNsYXNzPSJ3ci1zdWJqZWN0Ij4uKj88YSBocmVmPSIoP1A8bGluaz4uKz8pIi4qPz4oP1A8dGl0bGU+Lis/KTwvYT4hc2knLA0KDQogICAgIyDI+DfBbCigDLgMfCkAIIiUIJh0wFggaHRtbEQgG0AgxCD4rCDAvWAgtKnkOiAIKSBhcnJheSgiL21hZ25ldF9saW5rXCgnL2kiLCAiaHJlZj0nbWFnbmV0Oj94dD11cm46YnRpaDoiKSwNCiAgICAiX2Rvd25fbGlua19wcmVwcm9jZXNzIiA9PiBhcnJheSgpLA0KDQogICAgIyDI+DcgFd1EID6U5C4NCiAgICAiX2Rvd25fbGluayIgPT4gJ21hZ25ldCcsDQoNCiAgICAjIJh0wCC00CDI+DcgwWx8IHicWMAgSuAguRUgVVJMXCCUrVh0IPyUIL2wACCI5C4NCiAgICAjIHTwICAVWCCUrSBVUkxEID4wIARcICg0RCD4rCAVWHR8IFzkLiANCiAgICAiX21hZ25ldF9mb2xsb3dfbGluayIgPT4gJycNCik7DQoNCg0KIyCAybQgU2V0OiA4uFwg8V0cIHSERCCAyaTM3FwgrKlYdCBciNAg5BEggMlEIOTcXOQuDQokS0VZV09SRFMgPSBhcnJheSgNCiAgICAic2V0MDEiID0+IGFycmF5KCJ8FCSkwCA3MjBwLU5FWFQiLCAigHQgUFjIIDcyMHAtTkVYVCIsICKYIDyQILDkIDcyMHAtTkVYVCIpLA0KICAgICJzZXQwMiIgPT4gYXJyYXkoIiAgNIggKCBUIBTtIDcyMHAtTkVYVCIpDQopOw0KDQojIGN1cmwglK0g3CCsqWAgcHJveHkg/IwuIGlwOnBvcnQNCiRQUk9YWSA9ICcnOw0KDQpkZWZpbmUoJ1ZFUlNJT04nLCAndjIwMjIxMDAxJyk7ICAjIGFwcCB2ZXJzaW9uDQpkZWZpbmUoJ0FVVE9fVVBEQVRFJywgdHJ1ZSk7ICAjIJDZIMVwdLggMKUgrKkNCmRlZmluZSgnTUFHTkVUX0NBQ0hFX0NPTlNFUlZFX0RBWVMnLCA0NTApOyAgICMgyPg3IJDcIPR0fBgNCmRlZmluZSgnVVBEQVRFX1VSTCcsICdodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vYmp0b3dlci90b3JyL21hc3Rlci90b3JyLmVuY29kZWQnKTsgICMgdG9yciCQ2SDFcHS4IHVybA0KDQokbG9nZ2VyID0gbmV3IE15bG9nZ2VyKCk7DQokbG9nZ2VyLT5zZXRMZXZlbCgnREVCVUcnKTsgICMgREVCVUcsIElORk8sIFdBUk4sIEVSUk9SfCCsqWAgGCCI5C4NCg0KIyCsqZAgJBUgDHxEIH20HCAw+CAkFUQgMeBc5C4NCiMgpGy9uCAMfEAgkNkgxXB0uAAgGDAgTDjQIPR0dCBElFwgJBVAIFVzZXJDb25maWcucGhw0CAVWFzkLg0KaWYgKGZpbGVfZXhpc3RzKCdVc2VyQ29uZmlnLnBocCcpKSBpbmNsdWRlICdVc2VyQ29uZmlnLnBocCc7DQoNCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyBDb21tb24gdXRpbCBmdW5jdGlvbnMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQpjbGFzcyBNeUxvZ2dlcg0Kew0KICAgIHByaXZhdGUgJGxvZ2YgPSBudWxsOw0KICAgIHByaXZhdGUgJGxldmVsID0gJ0lORk8nOw0KDQogICAgcHVibGljIGZ1bmN0aW9uIF9fY29uc3RydWN0KCkNCiAgICB7DQogICAgICAgIGRhdGVfZGVmYXVsdF90aW1lem9uZV9zZXQoJ0FzaWEvU2VvdWwnKTsNCiAgICAgICAgJHRoaXMtPmxvZ2YgPSBiYXNlbmFtZShfX0ZJTEVfXywgJy5waHAnKSAuICcubG9nJzsNCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gc2V0TGV2ZWwoJGxldmVsKQ0KICAgIHsNCiAgICAgICAgJHRoaXMtPmxldmVsID0gJGxldmVsOw0KICAgIH0NCg0KICAgIHB1YmxpYyBmdW5jdGlvbiBkZWJ1ZygkbXNnKQ0KICAgIHsNCiAgICAgICAgaWYgKCR0aGlzLT5sZXZlbCA9PSAnREVCVUcnKSB7DQogICAgICAgICAgICAkdGhpcy0+X2xvZygnRCcsICRtc2cpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIGluZm8oJG1zZykNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+bGV2ZWwgPT0gJ0lORk8nIHx8ICR0aGlzLT5sZXZlbCA9PSAnREVCVUcnKSB7DQogICAgICAgICAgICAkdGhpcy0+X2xvZygnSScsICRtc2cpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcHVibGljIGZ1bmN0aW9uIHdhcm4oJG1zZykNCiAgICB7DQogICAgICAgIGlmICgkdGhpcy0+bGV2ZWwgPT0gJ1dBUk4nIHx8ICR0aGlzLT5sZXZlbCA9PSAnSU5GTycgfHwgJHRoaXMtPmxldmVsID09ICdERUJVRycpIHsNCiAgICAgICAgICAgICR0aGlzLT5fbG9nKCdXJywgJG1zZyk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICBwdWJsaWMgZnVuY3Rpb24gZXJyb3IoJG1zZykNCiAgICB7DQogICAgICAgICR0aGlzLT5fbG9nKCdFJywgJG1zZyk7DQogICAgfQ0KDQogICAgcHJpdmF0ZSBmdW5jdGlvbiBfbG9nKCRsZXZlbCwgJG1zZykNCiAgICB7DQogICAgICAgICR0ID0gbWljcm90aW1lKHRydWUpOw0KICAgICAgICAkbWlsbGkgPSBzcHJpbnRmKCIlMDNkIiwgKCR0IC0gZmxvb3IoJHQpKSAqIDEwMDApOw0KICAgICAgICAkZHQgPSBzcHJpbnRmKCIlcy4lcyIsIGRhdGUoJ1ktbS1kIEg6aTpzJyksICRtaWxsaSk7DQogICAgICAgICRidCA9IGRlYnVnX2JhY2t0cmFjZSgpOw0KICAgICAgICAkZnVuYyA9IGlzc2V0KCRidFsyXSkgPyAkYnRbMl1bJ2Z1bmN0aW9uJ10gOiAnX19tYWluX18nOw0KICAgICAgICAkY2FsbGVyID0gJGJ0WzFdOw0KICAgICAgICAkZmlsZSA9IGJhc2VuYW1lKCRjYWxsZXJbJ2ZpbGUnXSk7DQogICAgICAgICRvdXRwdXQgPSBzcHJpbnRmKCIlcyAlcyA8JXM6JXM6JWQ+ICVzXG4iLCAkZHQsICRsZXZlbCwgJGZpbGUsICRmdW5jLCAkY2FsbGVyWydsaW5lJ10sIHByaW50X3IoJG1zZywgdHJ1ZSkpOw0KICAgICAgICBlcnJvcl9sb2coJG91dHB1dCwgMywgJHRoaXMtPmxvZ2YpOw0KICAgIH0NCn0NCg0KDQojIFVzZXItQWdlbnRAIHJlZmVyZXJ8ICDAWJQg+SDQyTANCmZ1bmN0aW9uIGN1cmxfZmV0Y2goJHVybCwgJGluaXQgPSBmYWxzZSkNCnsNCiAgICBnbG9iYWwgJGxvZ2dlcjsNCiAgICBnbG9iYWwgJFBST1hZOw0KICAgIHN0YXRpYyAkY2ggPSBudWxsOw0KICAgIHN0YXRpYyAkY250ID0gMDsNCg0KICAgICgrKyRjbnQpICUgMTAgPT0gMCAmJiBzbGVlcCgyKTsgICMg6NwEILTQIAg0IM50IHCMWHQgKOj5YCAYxCCI5A0KDQogICAgJGNvb2tpZV9ubSA9ICcuL2Nvb2tpZS50eHQnOw0KDQogICAgaWYgKCRjaCA9PSBudWxsIHx8ICRpbml0ID09IHRydWUpIHsNCiAgICAgICAgJGNoICE9IG51bGwgJiYgY3VybF9jbG9zZSgkY2gpOw0KDQogICAgICAgICRjaCA9IGN1cmxfaW5pdCgpOw0KDQogICAgICAgIGN1cmxfc2V0b3B0KCRjaCwgQ1VSTE9QVF9VU0VSQUdFTlQsICdNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXaW42NDsgeDY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTAwLjAuNDg5Ni4xMjcgU2FmYXJpLzUzNy4zNicpOw0KICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIGZhbHNlKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0FVVE9SRUZFUkVSLCB0cnVlKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1JFVFVSTlRSQU5TRkVSLCB0cnVlKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0NPT0tJRVNFU1NJT04sIHRydWUpOw0KICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfQ09PS0lFSkFSLCAkY29va2llX25tKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0ZPTExPV0xPQ0FUSU9OLCB0cnVlKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1ZFUkJPU0UsIGZhbHNlKTsNCiAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hFQURFUiwgdHJ1ZSk7DQoNCiAgICAgICAgaWYgKCRQUk9YWSkgew0KICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BST1hZVFlQRSwgQ1VSTFBST1hZX0hUVFApOw0KICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX0hUVFBQUk9YWVRVTk5FTCwgMSk7DQogICAgICAgICAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfU1NMX1ZFUklGWVBFRVIsIDApOw0KICAgICAgICAgICAgY3VybF9zZXRvcHQoJGNoLCBDVVJMT1BUX1BST1hZLCAkUFJPWFkpOw0KDQogICAgICAgICAgICAkbG9nZ2VyLT5pbmZvKCJQcm94eSBzZXR0aW5nIGFwcGxpZWQuIFByb3h5IGluZm86ICRQUk9YWSIpOw0KICAgICAgICB9DQoNCiAgICB9DQoNCiAgICBjdXJsX3NldG9wdCgkY2gsIENVUkxPUFRfVVJMLCAkdXJsKTsNCiAgICAkcmVzcG9uc2UgPSBjdXJsX2V4ZWMoJGNoKTsNCiAgICAkaHR0cF9jb2RlID0gY3VybF9nZXRpbmZvKCRjaCwgQ1VSTElORk9fSFRUUF9DT0RFKTsNCiAgICBsaXN0KCRoZWFkZXIsICRib2R5KSA9IGV4cGxvZGUoIlxyXG5cclxuIiwgJHJlc3BvbnNlLCAyKTsNCg0KICAgICRzaXplID0gc3RybGVuKCRib2R5KTsNCg0KICAgICRsb2dnZXItPmRlYnVnKCJjVVJMIGZldGNoIGh0dHBfY29kZTpbJGh0dHBfY29kZV0gdXJsOlskdXJsXSAgc2l6ZTpbJHNpemVdIik7DQogICAgLy8gJGxvZ2dlci0+ZGVidWcoJGhlYWRlcik7DQogICAgLy8gJGxvZ2dlci0+ZGVidWcoJGJvZHkpOw0KDQogICAgcmV0dXJuIGFycmF5KCRodHRwX2NvZGUsICRoZWFkZXIsICRib2R5KTsNCn0NCg0KDQojIMEA/Ix8ICRiYXNlIDAYWCAIAPyMXCAYWFzkLg0KZnVuY3Rpb24gdXJsX2pvaW4oJGJhc2UsICRyZWxhdGl2ZV91cmwpDQp7DQogICAgLyogcmV0dXJuIGlmIGFscmVhZHkgYWJzb2x1dGUgVVJMICovDQogICAgaWYgKHBhcnNlX3VybCgkcmVsYXRpdmVfdXJsLCBQSFBfVVJMX1NDSEVNRSkgIT0gJycpIHJldHVybiAkcmVsYXRpdmVfdXJsOw0KDQogICAgLyogcXVlcmllcyBhbmQgYW5jaG9ycyAqLw0KICAgIGlmICgkcmVsYXRpdmVfdXJsWzBdID09ICcjJyB8fCAkcmVsYXRpdmVfdXJsWzBdID09ICc/JykgcmV0dXJuICRiYXNlIC4gJHJlbGF0aXZlX3VybDsNCg0KICAgIC8qIHBhcnNlIGJhc2UgVVJMIGFuZCBjb252ZXJ0IHRvIGxvY2FsIHZhcmlhYmxlczogJHNjaGVtZSwgJGhvc3QsICRwYXRoICovDQogICAgJHBhcnNlZCA9IHBhcnNlX3VybCgkYmFzZSk7DQogICAgJHNjaGVtZSA9ICRwYXJzZWRbJ3NjaGVtZSddOw0KICAgICRob3N0ID0gJHBhcnNlZFsnaG9zdCddOw0KICAgICRwYXRoID0gaXNzZXQoJHBhcnNlZFsncGF0aCddKSA/ICRwYXJzZWRbJ3BhdGgnXSA6ICcnOw0KDQogICAgLyogcmVtb3ZlIG5vbi1kaXJlY3RvcnkgZWxlbWVudCBmcm9tIHBhdGggKi8NCiAgICAkcGF0aCA9IHByZWdfcmVwbGFjZSgnIy9bXi9dKiQjJywgJycsICRwYXRoKTsNCg0KICAgIC8qIGRlc3Ryb3kgcGF0aCBpZiByZWxhdGl2ZSB1cmwgcG9pbnRzIHRvIHJvb3QgKi8NCiAgICBpZiAoJHJlbGF0aXZlX3VybFswXSA9PSAnLycpICRwYXRoID0gJyc7DQoNCiAgICAvKiBkaXJ0eSBhYnNvbHV0ZSBVUkwgKi8NCiAgICAkYWJzID0gIiRob3N0JHBhdGgvJHJlbGF0aXZlX3VybCI7DQoNCiAgICAvKiByZXBsYWNlICcvLycgb3IgJy8uLycgb3IgJy9mb28vLi4vJyB3aXRoICcvJyAqLw0KICAgICRyZSA9IGFycmF5KCcjKC9cLj8vKSMnLCAnIy8oPyFcLlwuKVteL10rL1wuXC4vIycpOw0KICAgIGZvciAoJG4gPSAxOyAkbiA+IDA7ICRhYnMgPSBwcmVnX3JlcGxhY2UoJHJlLCAnLycsICRhYnMsIC0xLCAkbikpIHsNCiAgICB9DQoNCiAgICAvKiBhYnNvbHV0ZSBVUkwgaXMgcmVhZHkhICovDQogICAgcmV0dXJuICRzY2hlbWUgLiAnOi8vJyAuICRhYnM7DQp9DQoNCg0KIyDkkVwgjKTQHCBtYWduZXQgbGlua3wgPpTkLg0KIyAo3MQxKSAkc291cmNlACB1cmwoaHR0cFwg3JEpeCC9sCBoZWFkZXJAIGh0bWxEIBuU5C4NCiMgKNzEMikgtKQgrHS4lCBtYWduZXREIMERIHicWMAgSuAguRUgdXJsXCAR/IhEIEwgMzAyIFH1/CBo2CBoZWFkZXJYIExvY2F0aW9u0CD0RBwgtCT0tDDEIFzkLg0KIyAgICAgICAgIDB8HCBoZWFkZXLQHCBMb2NhdGlvbiBtqdAgbWFnbmV0IMFsACCIlMCAMCBVeFjkLg0KIyAo3MQzKSAkc291cmNlACB1cmx0IETIcJgg3MQy0BwgG0AgaHRtbHQgiJQgvbAgbWFnbmV0IGxpbmsgcGF0dGVybjxcID6U5C4NCmZ1bmN0aW9uIGZpbmRfbWFnbmV0KCRzb3VyY2UpDQp7DQogICAgZ2xvYmFsICRsb2dnZXI7DQogICAgJGh0bWwgPSBudWxsOw0KICAgICRtYWduZXQgPSBudWxsOw0KDQogICAgaWYgKHByZWdfbWF0Y2goJy9eaHR0cC9zaScsICRzb3VyY2UsICRtYXRjaCkpIHsNCiAgICAgICAgbGlzdCgkaHR0cF9jb2RlLCAkaGVhZGVyLCAkaHRtbCkgPSBjdXJsX2ZldGNoKCRzb3VyY2UpOw0KICAgICAgICBpZiAocHJlZ19tYXRjaCgnL15Mb2NhdGlvbjogKG1hZ25ldDouKykkL21pJywgJGhlYWRlciwgJG1hdGNoKSkgew0KICAgICAgICAgICAgJG1hZ25ldCA9ICRtYXRjaFsxXTsNCiAgICAgICAgICAgICRsb2dnZXItPmRlYnVnKCJMb2NhdGlvbiDkVNAcIG1hZ25ldCDBbHwgPli1yOQ6ICIgLiAkbWFnbmV0KTsNCiAgICAgICAgfQ0KICAgIH0gZWxzZSB7DQogICAgICAgICRodG1sID0gJHNvdXJjZTsNCiAgICB9DQoNCiAgICBpZiAocHJlZ19tYXRjaCgnL2hyZWY9W1wnIl0/KG1hZ25ldDouKz8pW1xzXCciPl0vc2knLCAkaHRtbCwgJG1hdGNoKSkgew0KICAgICAgICAkbWFnbmV0ID0gJG1hdGNoWzFdOw0KICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygiSFRNTCCYdMDQHCBtYWduZXQgwWx8ID5YtcjkOiAiIC4gJG1hZ25ldCk7DQogICAgfQ0KDQogICAgcmV0dXJuICRtYWduZXQ7DQp9DQoNCg0KIyB1cmwg7IAgEOgNCmZ1bmN0aW9uIGlzX3VybCgkdXJsKQ0Kew0KICAgIHJldHVybiBpc3NldChwYXJzZV91cmwoJHVybClbJ2hvc3QnXSk7DQp9DQoNCg0KIyAV3N1EIHSpXCDAvSCYrA0KZnVuY3Rpb24gcHJlcHJvY2VzcygkdGV4dCwgJHBhdHRlcm5zKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KICAgICR0ZXh0X2JmID0gJHRleHQ7DQogICAgJHRleHRfYWYgPSAkdGV4dDsNCg0KICAgICRjb3VudCA9IDA7DQogICAgZm9yICgkaSA9IDA7ICRpIDwgY291bnQoJHBhdHRlcm5zKTsgJGkgKz0gMikgew0KICAgICAgICAkdGV4dF9hZiA9IHByZWdfcmVwbGFjZSgkcGF0dGVybnNbJGldLCAkcGF0dGVybnNbJGkgKyAxXSwgJHRleHRfYmYsIC0xLCAkY291bnQpOw0KICAgICAgICBpZiAoJGNvdW50ID09IDApIHsNCiAgICAgICAgICAgICRsb2dnZXItPndhcm4oJ3ByZWdfcmVwbGFjZSBwYXR0ZXJuIGlzIG5vdCBmb3VuZDogJyAuICRwYXR0ZXJuc1skaV0pOw0KICAgICAgICAgICAgJHRleHRfYWYgPSAkdGV4dF9iZjsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRiZl9sZW4gPSBzdHJsZW4oJHRleHRfYmYpOw0KICAgICAgICAgICAgJGFmX2xlbiA9IHN0cmxlbigkdGV4dF9hZik7DQogICAgICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygidGV4dCBjaGFuZ2VkIGZvciAkY291bnQgdGltZXMuIExlbmd0aCBvZiBCZWZvcmUgdGV4dCBpcyAkYmZfbGVuIGFuZCBhZnRlciB0ZXh0IGlzICRhZl9sZW4iKTsNCiAgICAgICAgICAgICR0ZXh0X2JmID0gJHRleHRfYWY7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAjIERFVl9NT0RFICYmICRsb2dnZXItPmRlYnVnKCgnQUZURVIgUEFHRSBQcmVwcm9jZXNzJyk7DQogICAgIyBERVZfTU9ERSAmJiAkbG9nZ2VyLT5kZWJ1ZygoJHRleHQpOw0KDQogICAgcmV0dXJuICR0ZXh0X2FmOw0KfQ0KDQoNCiMgdXJsIBXcVDogJmFtcDt8ICZcIMC9WOwgGFhc5C4NCmZ1bmN0aW9uIHVybF9ub3JtYWxpemUoJHVybCkNCnsNCiAgICByZXR1cm4gc3RyX3JlcGxhY2UoJyZhbXA7JywgJyYnLCAkdXJsKTsNCn0NCg0KDQojIBXc3UQghSUbRCAMfFggtKlEIMC9XOQuDQpmdW5jdGlvbiBmaWxlX3JlZ2V4X3VwZGF0ZSgkZmlsZW5hbWUsICRyZWdleF9mciwgJHJlZ2V4X3RvKQ0Kew0KICAgICRvcmlnaW4gPSBmaWxlX2dldF9jb250ZW50cygkZmlsZW5hbWUpOw0KICAgICR1cGRhdGVkID0gcHJlZ19yZXBsYWNlKCRyZWdleF9mciwgJHJlZ2V4X3RvLCAkb3JpZ2luKTsNCiAgICBmaWxlX3B1dF9jb250ZW50cygkZmlsZW5hbWUsICR1cGRhdGVkKTsNCn0NCg0KIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjDQojIyBCdXNpbmVzcyBmdW5jdGlvbnMNCiMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KDQojIHRvcnIucGhwIAx8IJDZxXB0uA0KIyAgLSCQ2SDFcHS4IMQgDHysdIgAIDAUdLgAIBiUICRYACCFhSAc3WggLT4g5LRc3CAbQCBsMHwgVXggxCAx4KBdIGgNCmZ1bmN0aW9uIHNlbGZfdXBkYXRlKCkNCnsNCiAgICBnbG9iYWwgJGxvZ2dlcjsNCg0KICAgICMgxXB0uCDkiSDsgCBVeA0KICAgIGlmICghQVVUT19VUERBVEUpIHJldHVybjsNCg0KICAgICMgWOjQIFyIzCDFcHS4ILRsfCB09JANCiAgICAkdXBkYXRlX2NoZWNrX2ZpbGUgPSBzeXNfZ2V0X3RlbXBfZGlyKCkgLiBESVJFQ1RPUllfU0VQQVJBVE9SIC4gJ3RvcnIudXBkYXRlY2hlY2snOw0KICAgIGlmIChAZmlsZV9nZXRfY29udGVudHMoJHVwZGF0ZV9jaGVja19maWxlKSA9PSBkYXRlKCdZbWQnKSkgcmV0dXJuOw0KICAgIGZpbGVfcHV0X2NvbnRlbnRzKCR1cGRhdGVfY2hlY2tfZmlsZSwgZGF0ZSgnWW1kJykpOw0KDQogICAgIyDQqSAApYzQHCCgDLggrHS4IBX0IBtEJDAgKFTcIPRIRCAEdCBiYXNlNjRcIHhUKRwgtKk8XCAblOQpDQogICAgbGlzdCgkaHR0cF9jb2RlLCAkaGVhZGVyLCAkcmVtb3RlX2Jhc2U2NCkgPSBjdXJsX2ZldGNoKFVQREFURV9VUkwpOw0KDQogICAgaWYgKCRodHRwX2NvZGUgIT0gMjAwKSB7DQogICAgICAgICRsb2dnZXItPndhcm4oIsVwdLggDHwg5LRc3CAkWIXI5C4gUfVU3DogJGh0dHBfY29kZSIpOw0KICAgICAgICByZXR1cm47DQogICAgfQ0KDQogICAgIyAErCAMfPwgRFBYMA0KICAgICRsb2NhbF9iYXNlNjQgPSBiYXNlNjRfZW5jb2RlKGZpbGVfZ2V0X2NvbnRlbnRzKF9fRklMRV9fKSk7DQoNCiAgICBpZiAoJGxvY2FsX2Jhc2U2NCAhPSAkcmVtb3RlX2Jhc2U2NCkgew0KICAgICAgICAkbG9nZ2VyLT5pbmZvKCJ0b3JyACDAvRi0IMVwdLh8INyRacjkLiIpOw0KDQogICAgICAgICMgBKwgpGy9uCAMfCAxxVgwDQogICAgICAgICFmaWxlX2V4aXN0cygnYmFja3VwJykgJiYgbWtkaXIoJ2JhY2t1cCcpOw0KICAgICAgICAkYmFja3VwZiA9IHNwcmludGYoImJhY2t1cC8lcy4lcy5waHAiLCBiYXNlbmFtZShfX0ZJTEVfXywgJy5waHAnKSwgVkVSU0lPTik7DQogICAgICAgIGNvcHkoX19GSUxFX18sICRiYWNrdXBmKTsNCiAgICAgICAgJGxvZ2dlci0+aW5mbyhzcHJpbnRmKCLFcHS4IATQIASsIHRvcnJ8IDHFiLXI5DogJXMgLT4gJXMiLCBiYXNlbmFtZShfX0ZJTEVfXyksICRiYWNrdXBmKSk7DQoNCiAgICAgICAgIyBiYXNlNjRcIHhUKSAcIBX0IHQdWDANCiAgICAgICAgJGRlY29kZWRfc291cmNlID0gYmFzZTY0X2RlY29kZSgkcmVtb3RlX2Jhc2U2NCk7DQoNCiAgICAgICAgIyAErCCkbL24IMVwdLghDQogICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKF9fRklMRV9fLCAkZGVjb2RlZF9zb3VyY2UpOyAgICMgwL0cILSpIDBdDQoNCiAgICAgICAgJGxvZ2dlci0+aW5mbygidG9ycnwgxXB0uIi1yOQuIORMiCCUrSDcIBgBKcjkLiIpOw0KICAgIH0gZWxzZSB7DQogICAgICAgICRsb2dnZXItPmluZm8oIgSsIHRvcnIAIFzgIIQEhcjkLiC0fCDk3CBVeGnI5C4iKTsNCiAgICB9DQp9DQoNCg0KIyAMfPgwfCCEHVjsINDJYCCM3BAg/IwgqV1EIN0xXOQuDQpmdW5jdGlvbiBwYXJzZV9wYXJhbSgpDQp7DQogICAgZ2xvYmFsICRsb2dnZXI7DQoNCiAgICAkbG9nZ2VyLT5pbmZvKHNwcmludGYoIlBhcmFtOiBiPVslc10gaz1bJXNdIiwgaXNzZXQoJF9HRVRbJ2InXSkgPyAkX0dFVFsnYiddIDogbnVsbCwgaXNzZXQoJF9HRVRbJ2snXSkgPyAkX0dFVFsnayddIDogbnVsbCkpOw0KDQogICAgJGNvbmYgPSAkR0xPQkFMU1snQ09ORklHJ107DQogICAgJGtleXcgPSAkR0xPQkFMU1snS0VZV09SRFMnXTsNCg0KICAgICRiID0gaXNzZXQoJF9HRVRbJ2InXSkgPyB0cmltKCRfR0VUWydiJ10pIDogJ2FsbCc7DQogICAgaWYgKCFpc3NldCgkY29uZlskYl0pKSB7DQogICAgICAgICRsb2dnZXItPmVycm9yKCRfR0VUWydiJ10gLiAilCAgqFjAIEpAIIzcEIXI5C4iKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgICRib2FyZHMgPSBhcnJheSgpOw0KICAgIGZvcmVhY2ggKCRjb25mWyRiXSBhcyAkaXRlbSkgew0KICAgICAgICBpZiAoaXNfdXJsKCRpdGVtKSkgew0KICAgICAgICAgICAgJGJvYXJkc1tdID0gYXJyYXkoJ2NhdGVnb3J5JyA9PiAkYiwgJ3VybCcgPT4gJGl0ZW0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgZm9yZWFjaCAoJGNvbmZbJGl0ZW1dIGFzICRpdGVtMikgew0KICAgICAgICAgICAgICAgICRib2FyZHNbXSA9IGFycmF5KCdjYXRlZ29yeScgPT4gJGl0ZW0sICd1cmwnID0+ICRpdGVtMik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAkayA9IGlzc2V0KCRfR0VUWydrJ10pID8gdHJpbSgkX0dFVFsnayddKSA6ICcnOw0KICAgICRrZXl3b3JkcyA9IGlzc2V0KCRrZXl3WyRrXSkgPyAka2V5d1ska10gOiBleHBsb2RlKCd8JywgJGspOw0KICAgICRrZXl3b3JkcyA9IHN0cl9yZXBsYWNlKCcgJywgJyUyMCcsICRrZXl3b3Jkcyk7DQoNCiAgICBpZiAoY291bnQoJGtleXdvcmRzKSA+IDEpIHsNCiAgICAgICAgJGxvZ2dlci0+aW5mbyhzcHJpbnRmKCLkEYDJIKTM3DogJWQcICglcykiLCBjb3VudCgka2V5d29yZHMpLCBqb2luKCIsICIsICRrZXl3b3JkcykpKTsNCiAgICB9DQoNCiAgICAkZmV0Y2hfdXJscyA9IGFycmF5KCk7DQogICAgZm9yZWFjaCAoJGJvYXJkcyBhcyAkYm9hcmQpIHsNCiAgICAgICAgZm9yZWFjaCAoJGtleXdvcmRzIGFzICRrZXl3b3JkKSB7DQogICAgICAgICAgICAkZmV0Y2hfdXJsc1tdID0gYXJyYXkoJ2NhdGVnb3J5JyA9PiAkYm9hcmRbJ2NhdGVnb3J5J10sICd1cmwnID0+IHN0cl9yZXBsYWNlKCd7a30nLCAka2V5d29yZCwgJGJvYXJkWyd1cmwnXSkpOyAgIyCAybQopMzcKSBwaQ0KICAgICAgICB9DQogICAgfQ0KDQogICAgJGxvZ2dlci0+ZGVidWcoJGZldGNoX3VybHMpOw0KDQogICAgcmV0dXJuICRmZXRjaF91cmxzOw0KfQ0KDQoNCiMgoAy4IKx0uCDEVHhAIPwwATxcIMC9GDAgTDjQIBGNdCCIAFwgvbDUIORMIMRUeEQgPkT45C4NCiMgkdkg0KwNCiMgICAtIETBIMRUeHQgtESIwMwg5yDAvSAgCBV4IL2wIFH15FRYIExvY2F0aW9u0CDAvSAgxFR4RCBR9ViUIL2wACCITA0KIyAgIC0gxFR40CB8KIg4ACCIlCC9sCCIOHwgnQDcpHQcIORMiCDEVHhEID5E+OQuICAIKSB3d3cudG9ycmVudGRpYTIuY29tID4gd3d3LnRvcnJlbnRkaWEzLmNvbQ0KIyAgIC0gwL0cIMRUeEAgVXNlckNvbmZpZy5waHDQIDBddFDgIORMgDCUIHT5IBX0fCCsqQ0KIyDAvSAcHA0KIyAgIDEpIFVzZXJDb25maWcucGhw0CDAvQTEIMRUeCAV9AAgiOR0IHT5IMRUeCCsqQ0KIyAgIDItMSkgxFR4dCAgqFzAIOQcXCARjUQg3MRY7CAQgCDEIExvY2F0aW9uIORUACCI5HQgxFR4IMC9DQojICAgMi0yKSBodHRwIFH1VNwAIBXBKDIwMCl0IETIfHQgxFR40CDsaBwgfCiIOHwgnQDcpHQcIORMIMRUeCCAyQ0KIyAgIDMpIMC9IBX0fCBVc2VyQ29uZmlnLnBocNAgMF0NCiMgDQpmdW5jdGlvbiB1cGRhdGVfZG9tYWluKCRib2FyZF91cmxzKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KICAgIGdsb2JhbCAkT0xEX0RPTUFJTiwgJE5FV19ET01BSU47DQoNCiAgICAjIDEuIKuI+CB1cmzQHCDEVHggFfQglJwNCiAgICAkcGFyc2VkID0gcGFyc2VfdXJsKCRib2FyZF91cmxzWzBdWyd1cmwnXSk7DQogICAgJGN1cnJlbnRfZG9tYWluID0gJHBhcnNlZFsnaG9zdCddOyAgICMgJENPTkZJR9AgMF0cIMRUeA0KICAgICRjaGFuZ2VkX2RvbWFpbiA9ICRjdXJyZW50X2RvbWFpbjsgICAjIFyFIMC9HCDEVHgNCg0KICAgICRsb2dnZXItPmRlYnVnKCJcJGN1cnJlbnRfZG9tYWluID0gJGN1cnJlbnRfZG9tYWluIik7DQoNCiAgICAjIDIuIFVzZXJDb25maWcucGhw0CAwXRwgwL0ExFR4KCRPTERfRE9NQUlOKfwgfFhc5HQgxFR4IMC9IJisDQogICAgaWYgKGlzc2V0KCRPTERfRE9NQUlOKSAmJiAkT0xEX0RPTUFJTiA9PSAkY3VycmVudF9kb21haW4pIHsNCiAgICAgICAgJGNoYW5nZWRfZG9tYWluID0gJE5FV19ET01BSU47DQogICAgICAgICRsb2dnZXItPmRlYnVnKCJVc2VyQ29uZmlnLnBocCAMfFggTkVXX0RPTUFJTiAV9HwgrKloOiAkTkVXX0RPTUFJTiIpOw0KICAgIH0NCg0KICAgICMgMy4g5BwgZmV0Y2hY7CDEVHh0IMC9EJTAIFV4DQogICAgJGNoZWNrX3VybCA9ICRwYXJzZWRbInNjaGVtZSJdIC4gJzovLycgLiAkY2hhbmdlZF9kb21haW47DQogICAgbGlzdCgkaHR0cF9jb2RlLCAkaGVhZGVyLCAkaHRtbCkgPSBjdXJsX2ZldGNoKCRjaGVja191cmwpOw0KDQogICAgIyBMb2NhdGlvbiDkVAAgiOSUIINAIMRUeHQgwL0Q5JQgOw0KICAgIGlmIChwcmVnX21hdGNoKCcvXkxvY2F0aW9uOiAoLispJC9taScsICRoZWFkZXIsICRtYXRjaCkpIHsNCiAgICAgICAgJGNoYW5nZWRfZG9tYWluID0gcGFyc2VfdXJsKCRtYXRjaFsxXSlbJ2hvc3QnXTsNCiAgICAgICAgJGxvZ2dlci0+aW5mbygiTG9jYXRpb24g5FTQHCDg3CDEVHhEID5YtcjkOiAiIC4gJGNoYW5nZWRfZG9tYWluKTsNCiAgICB9DQoNCiAgICAjIPggeCAVwSBR9UQguxtAIL2w1CDEVHjQIIiUIHwoiDh8ID5EIFiYKSCdAFh0HCDEVHhEID5E+OQuDQogICAgIyAIKSBodHRwczovL3RvcnJlbnR2aWV3MzguY29tLyA9PiAzOEQgMzksIDQwIPE8XCDAvVh0HCDIXLQgxFR4RCA+lOQuDQogICAgZWxzZSBpZiAoJGh0dHBfY29kZSAhPSAyMDApIHsNCiAgICAgICAgJG5ld19kb21haW5fZm91bmRlZCA9IGZhbHNlOw0KICAgICAgICBpZiAocHJlZ19tYXRjaCgnL14oLis/KShbXGRdezEsM30pKFwuLispJC8nLCAkY2hhbmdlZF9kb21haW4sICRtYXRjaCkpIHsNCiAgICAgICAgICAgICRkb21haW5fMDEgPSAkbWF0Y2hbMV07DQogICAgICAgICAgICAkZG9tYWluXzAyID0gaW50dmFsKCRtYXRjaFsyXSk7DQogICAgICAgICAgICAkZG9tYWluXzAzID0gJG1hdGNoWzNdOw0KICAgICAgICAgICAgDQogICAgICAgICAgICBmb3IoJGk9MDsgJGk8MTA7ICRpKyspIHsNCiAgICAgICAgICAgICAgICAkZG9tYWluXzAyKys7DQogICAgICAgICAgICAgICAgJHRyeV9kb21haW4gPSAgJGRvbWFpbl8wMSAuICRkb21haW5fMDIgLiAkZG9tYWluXzAzOw0KICAgICAgICAgICAgICAgICR0cnlfdXJsID0gJHBhcnNlZFsic2NoZW1lIl0gLiAnOi8vJyAuICR0cnlfZG9tYWluOw0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIGxpc3QoJGh0dHBfY29kZTIsICRoZWFkZXIyLCAkaHRtbDIpID0gY3VybF9mZXRjaCgkdHJ5X2RvbWFpbik7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgJGxvZ2dlci0+aW5mbygiVHJpZWQgdG8gY2hlY2sgaWYgJHRyeV91cmwgaXMgYWxpdmUuIGFuZCBodHRwX2NvZGUgaXMgJGh0dHBfY29kZTIiKTsNCiAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICBpZiAoJGh0dHBfY29kZTIgPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgICRuZXdfZG9tYWluX2ZvdW5kZWQgPSB0cnVlOw0KICAgICAgICAgICAgICAgICAgICAkY2hhbmdlZF9kb21haW4gPSAkdHJ5X2RvbWFpbjsNCiAgICAgICAgICAgICAgICAgICAgJGxvZ2dlci0+aW5mbygiwL0cIMRUeEQgPli1yOQ6ICIgLiAkY2hhbmdlZF9kb21haW4pOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoISRuZXdfZG9tYWluX2ZvdW5kZWQpIHsNCiAgICAgICAgICAgICRsb2dnZXItPmVycm9yKCJ0b3JyZW50IKx0uCBbJGN1cnJlbnRfZG9tYWluXSAAKHQpIP1AIO8gacjkLiCFzGnI5C4iKTsNCiAgICAgICAgICAgIGVycm9yX3Jlc3BvbnNlKCJ0b3JyZW50IKx0uCBbJGN1cnJlbnRfZG9tYWluXSAAKHQpIP1AIO8gacjkLiCFzGnI5C4iKTsNCiAgICAgICAgICAgIHNlbGZfdXBkYXRlKCk7DQogICAgICAgICAgICBleGl0KDApOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgIyA0LiB1cmwgqV3QHCDEVHggwL0NCiAgICBpZiAoJGN1cnJlbnRfZG9tYWluICE9ICRjaGFuZ2VkX2RvbWFpbikgew0KICAgICAgICBmb3JlYWNoICgkYm9hcmRfdXJscyBhcyAmJGJ1cmwpIHsNCiAgICAgICAgICAgICRidXJsWyd1cmwnXSA9IHN0cl9yZXBsYWNlKCRjdXJyZW50X2RvbWFpbiwgJGNoYW5nZWRfZG9tYWluLCAkYnVybFsndXJsJ10pOw0KICAgICAgICB9DQoNCiAgICAgICAgJGxvZ2dlci0+aW5mbygixFR4RCDAvWnI5DogIiAuICRjdXJyZW50X2RvbWFpbiAuICIgID4gICIgLiAkY2hhbmdlZF9kb21haW4pOw0KICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygkYm9hcmRfdXJscyk7DQogICAgfQ0KDQogICAgIyA1LiBVc2VyQ29uZmln0CDAvRwgxFR4IBX0IDBdDQogICAgaWYgKCRjdXJyZW50X2RvbWFpbiAhPSAkY2hhbmdlZF9kb21haW4pIHsNCiAgICAgICAgaWYgKCFmaWxlX2V4aXN0cygnVXNlckNvbmZpZy5waHAnKSkgew0KICAgICAgICAgICAgJGNvbnRlbnRzID0gIjw/UEhQXG5cblwkT0xEX0RPTUFJTiA9ICckY3VycmVudF9kb21haW4nO1xuXCRORVdfRE9NQUlOID0gJyRjaGFuZ2VkX2RvbWFpbic7XG4iOw0KICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJ1VzZXJDb25maWcucGhwJywgJGNvbnRlbnRzKTsNCiAgICAgICAgICAgICRsb2dnZXItPmluZm8oIlVzZXJDb25maWcucGhw0CDAvRwgxFR4IBX0fCCUAGgiKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgaWYgKCFpc3NldCgkT0xEX0RPTUFJTikpIHsNCiAgICAgICAgICAgIGZpbGVfcHV0X2NvbnRlbnRzKCdVc2VyQ29uZmlnLnBocCcsICJcblwkT0xEX0RPTUFJTiA9ICckY3VycmVudF9kb21haW4nO1xuIiwgRklMRV9BUFBFTkQpOw0KICAgICAgICAgICAgJGxvZ2dlci0+aW5mbygiVXNlckNvbmZpZy5waHDQIMRUeCAV9HwglABoOiBcJE9MRF9ET01BSU4gPSAnJGN1cnJlbnRfZG9tYWluJyIpOw0KICAgICAgICB9DQogICAgICAgIGVsc2UgaWYgKCRPTERfRE9NQUlOICE9ICRjdXJyZW50X2RvbWFpbikgew0KICAgICAgICAgICAgZmlsZV9yZWdleF91cGRhdGUoJ1VzZXJDb25maWcucGhwJywgJy9eXCRPTERfRE9NQUlOID0gLisvaW0nLCAiXCRPTERfRE9NQUlOID0gJyRjdXJyZW50X2RvbWFpbic7Iik7DQogICAgICAgICAgICAkbG9nZ2VyLT5pbmZvKCJVc2VyQ29uZmlnLnBocNAgxFR4IBX0fCAx4Gg6IFwkT0xEX0RPTUFJTiA9ICckY3VycmVudF9kb21haW4nIik7DQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIWlzc2V0KCRORVdfRE9NQUlOKSkgew0KICAgICAgICAgICAgZmlsZV9wdXRfY29udGVudHMoJ1VzZXJDb25maWcucGhwJywgIlxuXCRORVdfRE9NQUlOID0gJyRjaGFuZ2VkX2RvbWFpbic7XG4iLCBGSUxFX0FQUEVORCk7DQogICAgICAgICAgICAkbG9nZ2VyLT5pbmZvKCJVc2VyQ29uZmlnLnBocNAgxFR4IBX0fCCUAGg6IFwkTkVXX0RPTUFJTiA9ICckY2hhbmdlZF9kb21haW4nIik7DQogICAgICAgIH0gDQogICAgICAgIGVsc2UgaWYgKCRORVdfRE9NQUlOICE9ICRjaGFuZ2VkX2RvbWFpbikgew0KICAgICAgICAgICAgZmlsZV9yZWdleF91cGRhdGUoJ1VzZXJDb25maWcucGhwJywgJy9eXCRORVdfRE9NQUlOID0gLisvaW0nLCAiXCRORVdfRE9NQUlOID0gJyRjaGFuZ2VkX2RvbWFpbic7Iik7DQogICAgICAgICAgICAkbG9nZ2VyLT5pbmZvKCJVc2VyQ29uZmlnLnBocNAgxFR4IBX0fCAx4Gg6IFwkTkVXX0RPTUFJTiA9ICckY2hhbmdlZF9kb21haW4nIik7DQogICAgICAgICAgICB9DQogICAgICAgIH0NCiAgICB9DQoNCiAgICByZXR1cm4gJGJvYXJkX3VybHM7DQp9DQoNCg0KIyCgDLggjNwQ5NAcIER0XCgcqSwgmHTAwWwpfCCUnFzkLg0KZnVuY3Rpb24gZ2V0X2l0ZW1zKCRib2FyZF91cmxzKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KDQogICAgJHNlbGYgPSAnaHR0cCcgLiAoaXNzZXQoJF9TRVJWRVJbJ0hUVFBTJ10pID8gJ3MnIDogJycpIC4gJzovLycgLiAkX1NFUlZFUlsnSFRUUF9IT1NUJ10gLiBwYXJzZV91cmwoJF9TRVJWRVJbJ1JFUVVFU1RfVVJJJ10pWydwYXRoJ107DQogICAgJHBhdHRlcm4gPSAkR0xPQkFMU1snQ09ORklHJ11bJ19wYWdlX2xpbmsnXTsNCiAgICAkcmVwbGFjZV9wYXR0ZXJucyA9ICRHTE9CQUxTWydDT05GSUcnXVsnX3BhZ2VfbGlua19wcmVwcm9jZXNzJ107DQogICAgJGlzX21hZ25ldCA9ICRHTE9CQUxTWydDT05GSUcnXVsnX2Rvd25fbGluayddID09ICdtYWduZXQnOw0KICAgICRpdGVtcyA9IGFycmF5KCk7DQoNCiAgICAkYmNudCA9IDA7DQoNCiAgICBmb3JlYWNoICgkYm9hcmRfdXJscyBhcyAkYnVybCkgew0KICAgICAgICAkYmNudCsrOw0KICAgICAgICAkdXJsID0gJGJ1cmxbJ3VybCddOw0KICAgICAgICAkY2F0ZWdvcnkgPSAkYnVybFsnY2F0ZWdvcnknXTsNCg0KICAgICAgICBsaXN0KCRodHRwX2NvZGUsICRoZWFkZXIsICRodG1sKSA9IGN1cmxfZmV0Y2goJHVybCk7DQoNCiAgICAgICAgaWYgKCRodHRwX2NvZGUgIT0gMjAwKSB7DQogICAgICAgICAgICAkbG9nZ2VyLT5lcnJvcigiRXJyb3IuIEZldGNoIGZyb20gJHVybCByZXR1cm5lZCBodHRwX2NvZGUgJGh0dHBfY29kZSIpOw0KICAgICAgICAgICAgJGxvZ2dlci0+ZXJyb3IoJGhlYWRlcik7DQogICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgfQ0KDQogICAgICAgICMgaHRtbCC0qVggfIB8IPisIMC9DQogICAgICAgIGlmICgkcmVwbGFjZV9wYXR0ZXJucykgew0KICAgICAgICAgICAgJGh0bWwgPSBwcmVwcm9jZXNzKCRodG1sLCAkcmVwbGFjZV9wYXR0ZXJucyk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygnSFRNTEQgBJisIMC9WMAgSrXI5C4nKTsNCiAgICAgICAgfQ0KDQogICAgICAgIHByZWdfbWF0Y2hfYWxsKCRwYXR0ZXJuLCAkaHRtbCwgJG1hdGNoZXMsIFBSRUdfU0VUX09SREVSKTsNCg0KICAgICAgICAkY250ID0gMDsNCg0KICAgICAgICBmb3JlYWNoICgkbWF0Y2hlcyBhcyAkbWF0Y2gpIHsNCg0KICAgICAgICAgICAgJGNudCsrOw0KDQogICAgICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygkbWF0Y2gpOw0KDQogICAgICAgICAgICAjIByp0CDsaBwgaHRtbCDc+EAgXqQg9TFEIBxwXOQuDQogICAgICAgICAgICAkdGl0bGUgPSB0cmltKGh0bWxfZW50aXR5X2RlY29kZShzdHJpcF90YWdzKCRtYXRjaFsndGl0bGUnXSkpLCAiIFx0XG5cclwwXHgwQlx4QzJceEEwIik7ICAgICMgJm5ic3A7lCBceEMyXHhBMFwgwFgc5C4NCg0KICAgICAgICAgICAgIyBVUkwg9BU6IAgAIPyMXCDAvSDEIPysOJD00CAnJmFtcDsnlCAnJidcIMC9XOQuDQogICAgICAgICAgICAkcGFnZSA9IHVybF9qb2luKCR1cmwsIHVybF9ub3JtYWxpemUoJG1hdGNoWydsaW5rJ10pKTsNCiAgICAgICAgICAgICRsb2dnZXItPmRlYnVnKCJOb3JtYWxpemVkIHVybCBpcyAkcGFnZSIpOw0KDQogICAgICAgICAgICBpZiAoJGlzX21hZ25ldCkgew0KICAgICAgICAgICAgICAgICMgyPg3IMFsTMAgGNGI5HQg+HggrKlY4CD4B8AgSjx0IBzEIJh0wFwg5LQAHCDI+DcgwWx8ID6U5C4NCiAgICAgICAgICAgICAgICAkbGluayA9IGlzc2V0KCRtYXRjaFsnbWFnbmV0J10pID8gJG1hdGNoWydtYWduZXQnXSA6IGdldF9tYWduZXRfbGluaygkcGFnZSk7DQogICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICRsaW5rID0gJHNlbGYgLiAnP2Q9JyAuIGJhc2U2NF9lbmNvZGUoJHBhZ2UpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgJGl0ZW1zW10gPSBhcnJheSgndGl0bGUnID0+ICR0aXRsZSwgJ2xpbmsnID0+ICRsaW5rLCAncGFnZScgPT4gJHBhZ2UsICdjYXRlZ29yeScgPT4gJGNhdGVnb3J5KTsNCg0KICAgICAgICAgICAgIyBpZiAoJGNudCA+PSAzKSBicmVhazsgICMgVG9kbyAcHCBEzCDEIPwdmKx0fCBoDQogICAgICAgIH0NCg0KICAgICAgICAkbG9nZ2VyLT5pbmZvKHNwcmludGYoIlslZC8lZF0gJWR0WCCw/HwgPli1yOQuIIDJVVJMOiAlcyIsICRiY250LCBjb3VudCgkYm9hcmRfdXJscyksICRjbnQsICR1cmwpKTsNCiAgICB9DQoNCiAgICAkbG9nZ2VyLT5kZWJ1ZygkaXRlbXMpOw0KDQogICAgcmV0dXJuICRpdGVtczsNCn0NCg0KDQojIJDc0BwgyPg3IMFsfCA+RPTgIMY8dCB1cmzQHCA+RCAYWFzkLg0KZnVuY3Rpb24gZ2V0X21hZ25ldF9saW5rKCR1cmwpDQp7DQogICAgZ2xvYmFsICRsb2dnZXI7DQoNCiAgICAkbWFnbmV0ID0gbnVsbDsNCiAgICAkcmVwbGFjZV9wYXR0ZXJucyA9ICRHTE9CQUxTWydDT05GSUcnXVsnX2Rvd25fbGlua19wcmVwcm9jZXNzJ107DQoNCiAgICAjIMj4NyCQ3NAcIMFsfCA+RPjkLg0KICAgIGlmICgkbWFnbmV0ID0gbWFnbmV0X2NhY2hlX2NvbnRyb2woJ1F1ZXJ5JywgJHVybCkpIHsNCiAgICAgICAgJGxvZ2dlci0+ZGVidWcoIpDc0BwgyPg3IMFsfCA+WLXI5C4iKTsNCiAgICAgICAgJGxvZ2dlci0+ZGVidWcoIpStVVJMOiAkdXJsIik7DQogICAgICAgICRsb2dnZXItPmRlYnVnKCJNYWduZXQ6ICRtYWduZXQiKTsNCiAgICAgICAgcmV0dXJuICRtYWduZXQ7DQogICAgfQ0KDQogICAgIyD5mHTA0BwgyPg3IMFsfCA+lOQuDQogICAgbGlzdCgkaHR0cF9jb2RlLCAkaGVhZGVyLCAkaHRtbCkgPSBjdXJsX2ZldGNoKCR1cmwpOw0KICAgIGlmICgkaHR0cF9jb2RlICE9IDIwMCkgew0KICAgICAgICAkbG9nZ2VyLT5lcnJvcigiRXJyb3IuIEZldGNoaW5nIHBhZ2UgZnJvbSAkdXJsIHJldHVybmVkIGh0dHBfY29kZSAkaHR0cF9jb2RlIik7DQogICAgICAgIHJldHVybiBudWxsOw0KICAgIH0NCg0KICAgICMgaHRtbCC0qVggfIB8IPisIMC9DQogICAgaWYgKCRyZXBsYWNlX3BhdHRlcm5zKSB7DQogICAgICAgICRodG1sID0gcHJlcHJvY2VzcygkaHRtbCwgJHJlcGxhY2VfcGF0dGVybnMpOyANCiAgICB9DQoNCiAgICAkbWFnbmV0ID0gZmluZF9tYWduZXQoJGh0bWwpOw0KDQogICAgaWYgKCEkbWFnbmV0ICYmICRHTE9CQUxTWydDT05GSUcnXVsnX21hZ25ldF9mb2xsb3dfbGluayddKSB7DQoNCiAgICAgICAgLy8gJGxvZ2dlci0+ZGVidWcoJGh0bWwpOw0KDQogICAgICAgICRwYXR0ZXJuID0gJEdMT0JBTFNbJ0NPTkZJRyddWydfbWFnbmV0X2ZvbGxvd19saW5rJ107DQogICAgICAgICRsb2dnZXItPmRlYnVnKCJfbWFnbmV0X2ZvbGxvd19saW5rfCA+RAXI5DogJHBhdHRlcm4iKTsNCiAgICAgICAgaWYgKHByZWdfbWF0Y2goJHBhdHRlcm4sICRodG1sLCAkbWF0Y2gpKSB7DQogICAgICAgICAgICAkbG9nZ2VyLT5kZWJ1ZygiX21hZ25ldF9mb2xsb3dfbGlua3wgPli1yOQ6ICIgLiAkbWF0Y2hbJ3VybCddKTsNCg0KICAgICAgICAgICAgJGZvbGxvd191cmwgPSB1cmxfam9pbigkdXJsLCAkbWF0Y2hbJ3VybCddKTsNCiAgICAgICAgICAgICRsb2dnZXItPmRlYnVnKCfI+DcgwWx8ID4wBHQg5EwgmHTAXCB02WnI5C4gJyAuICRmb2xsb3dfdXJsKTsNCg0KICAgICAgICAgICAgJG1hZ25ldCA9IGZpbmRfbWFnbmV0KCRmb2xsb3dfdXJsKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICRsb2dnZXItPmVycm9yKCckWCEgX21hZ25ldF9mb2xsb3dfbGluayAoNEQgPkQgGCDGtcjkLicpOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgIyDI+DcgkNzQIMFsfCDFcHS4XOQuDQogICAgJG1hZ25ldCAmJiBtYWduZXRfY2FjaGVfY29udHJvbCgnVXBkYXRlJywgJHVybCwgJG1hZ25ldCk7DQoNCiAgICAjIMj4NyDBbHwgGFhc5C4NCiAgICByZXR1cm4gJG1hZ25ldDsNCn0NCg0KDQojIMj4NyDBbFggkNx8IACsXOQuIChwjCwglAAsIAClLCAkmBwgcHTAIK0cKQ0KZnVuY3Rpb24gbWFnbmV0X2NhY2hlX2NvbnRyb2woJGFjdGlvbiwgJHVybCA9IG51bGwsICRtYWduZXQgPSBudWxsKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KDQogICAgc3RhdGljICRtYWduZXRfY2FjaGUgPSAnTi9BJywgJGNhY2hlX2ZpbGUgPSBudWxsLCAkY2FjaGVfdXBkYXRlZCA9IGZhbHNlOw0KICAgICRrZXkgPSBudWxsOw0KDQogICAgIyB1cmzQHCCM3Dwg4CCIOCgrkCA0kKwgdMEpQCCQ3Ax8hUQgPpTkLg0KICAgIGlmICgkdXJsKSB7DQogICAgICAgIGlmIChwcmVnX21hdGNoKCcvXGRcZFxkXGQrLycsICR1cmwsICRtYXRjaCkpIHsNCiAgICAgICAgICAgICRrZXkgPSAkbWF0Y2hbMF07DQogICAgICAgIH0NCiAgICAgICAgaWYgKCRjYWNoZV9maWxlID09IG51bGwpIHsNCiAgICAgICAgICAgICRob3N0ID0gcGFyc2VfdXJsKCR1cmwpWydob3N0J107DQogICAgICAgICAgICAkY2FjaGVfZmlsZSA9IHN5c19nZXRfdGVtcF9kaXIoKSAuIERJUkVDVE9SWV9TRVBBUkFUT1IgLiAndG9yci4nIC4gJGhvc3QgLiAnLmNhY2hlJzsNCiAgICAgICAgICAgICRsb2dnZXItPmRlYnVnKCKQ3Ax8QCAkY2FjaGVfZmlsZSCFyOQuIik7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAjIJDc0BwgyPg3IMFsIHCMDQogICAgaWYgKCRhY3Rpb24gPT0gJ1F1ZXJ5Jykgew0KICAgICAgICAjIMj4NyCQ3AAgEHR0IAx80BwgfbTkeOQuDQogICAgICAgIGlmICgkbWFnbmV0X2NhY2hlID09ICdOL0EnKSB7DQogICAgICAgICAgICAkY29udGVudCA9IEBmaWxlX2dldF9jb250ZW50cygkY2FjaGVfZmlsZSk7DQogICAgICAgICAgICBpZiAoJGNvbnRlbnQgIT0gZmFsc2UpIHsNCiAgICAgICAgICAgICAgICAkbWFnbmV0X2NhY2hlID0gdW5zZXJpYWxpemUoJGNvbnRlbnQpOw0KICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAkbWFnbmV0X2NhY2hlID0gYXJyYXkoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgICMgyPg3IJDc0Bwga2V5IHCMDQogICAgICAgIGlmIChpc3NldCgkbWFnbmV0X2NhY2hlWyRrZXldKSkgew0KICAgICAgICAgICAgJG1hZ25ldCA9ICRtYWduZXRfY2FjaGVbJGtleV1bJ21hZ25ldCddOw0KICAgICAgICAgICAgJGxvZ2dlci0+ZGVidWcoIpDc0BwgyPg3IMFsfCA+WLXI5C4ga2V5PVska2V5XSBtYWduZXQ9WyRtYWduZXRdIik7DQogICAgICAgICAgICByZXR1cm4gJG1hZ25ldDsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgICMgkNzQIMj4NyDBbCCUAA0KICAgIGVsc2VpZiAoJGFjdGlvbiA9PSAnVXBkYXRlJykgew0KICAgICAgICAjIMj4NyCQ3AAgEHR0ICRYIJisXOQuDQogICAgICAgIGlmICgkbWFnbmV0X2NhY2hlID09ICdOL0EnKSB7DQogICAgICAgICAgICAkbG9nZ2VyLT5lcnJvcigiRXJyb3IuIMj4NyCQ3AAg3TEYwCBKRCBVcGRhdGUgmKx8IGAgGCDGtcjkLiIpOw0KICAgICAgICAgICAgc2VsZl91cGRhdGUoKTsNCiAgICAgICAgICAgIGV4aXQoMSk7DQogICAgICAgIH0NCg0KICAgICAgICAjIMj4NyCQ3NAga2V5LCBtYWduZXQglAANCiAgICAgICAgJG1hZ25ldF9jYWNoZVska2V5XSA9IGFycmF5KCdtYWduZXQnID0+ICRtYWduZXQsICdpbnNlcnRlZCcgPT4gdGltZSgpKTsNCiAgICAgICAgJGNhY2hlX3VwZGF0ZWQgPSB0cnVlOw0KICAgIH0NCg0KICAgICMgkNx8IAx8XCAApQ0KICAgIGVsc2VpZiAoJGFjdGlvbiA9PSAnV3JpdGUnKSB7DQogICAgICAgIGlmICgkY2FjaGVfdXBkYXRlZCkgew0KICAgICAgICAgICAgIyC9ySCQ3CAgwHwgBHQgfBV8IHTBIL38XCBwdMCUIK0cXOQuDQogICAgICAgICAgICAkZGVsZXRlZCA9IDA7DQogICAgICAgICAgICBmb3JlYWNoICgkbWFnbmV0X2NhY2hlIGFzICRrZXkgPT4gJGl0ZW0pIHsNCiAgICAgICAgICAgICAgICBpZiAoJGl0ZW1bJ2luc2VydGVkJ10gKyAoTUFHTkVUX0NBQ0hFX0NPTlNFUlZFX0RBWVMgKiA2MCAqIDYwICogMjQpIDwgdGltZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIHVuc2V0KCRtYWduZXRfY2FjaGVbJGtleV0pOw0KICAgICAgICAgICAgICAgICAgICAkZGVsZXRlZCsrOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICRkZWxldGVkID4gMCAmJiAkbG9nZ2VyLT5kZWJ1ZygiRGVsZXRlZCAkZGVsZXRlZCBjYWNoZSBpdGVtcy4iKTsNCg0KICAgICAgICAgICAgIyCQ3CAApQ0KICAgICAgICAgICAgJGNvbnRlbnQgPSBzZXJpYWxpemUoJG1hZ25ldF9jYWNoZSk7DQogICAgICAgICAgICBmaWxlX3B1dF9jb250ZW50cygkY2FjaGVfZmlsZSwgJGNvbnRlbnQpOw0KICAgICAgICAgICAgJGNhY2hlX3VwZGF0ZWQgPSBmYWxzZTsNCiAgICAgICAgfQ0KICAgIH0NCn0NCg0KDQojIKAMuCBEdFwoHKksIJh0wMFsKTxcIHJzc3wg3TFc5C4NCmZ1bmN0aW9uIGJ1aWxkX3JzcygkaXRlbXMpDQp7DQogICAgZ2xvYmFsICRsb2dnZXI7DQoNCiAgICAkc2VsZiA9ICdodHRwJyAuIChpc3NldCgkX1NFUlZFUlsnSFRUUFMnXSkgPyAncycgOiAnJykgLiAnOi8vJyAuICRfU0VSVkVSWydIVFRQX0hPU1QnXSAuICRfU0VSVkVSWydSRVFVRVNUX1VSSSddOw0KDQogICAgJGIgPSBpc3NldCgkX0dFVFsnYiddKSA/IHRyaW0oJF9HRVRbJ2InXSkgOiAnJzsNCiAgICAkayA9IGlzc2V0KCRfR0VUWydrJ10pID8gdHJpbSgkX0dFVFsnayddKSA6ICcnOw0KICAgIGlmICgkYiA9PSAnJyAmJiAkayA9PSAnJykgew0KICAgICAgICAkdGl0bGUgPSAiSXQncyB0b3JyISI7DQogICAgfSBlbHNlIHsNCiAgICAgICAgJHRpdGxlID0gIkl0J3MgdG9yciEgKCIgLiAoJGIgPyAkYiAuICI6ICIgOiAiIikgLiAoJGsgPyAkayA6ICJBbGwiKSAuICIpIjsNCiAgICB9DQoNCiAgICAkcnNzICA9ICI8P3htbCB2ZXJzaW9uPVwiMS4wXCIgZW5jb2Rpbmc9XCJVVEYtOFwiID8+XG48cnNzIHZlcnNpb249XCIyLjBcIj5cbiI7DQogICAgJHJzcyAuPSAiPGNoYW5uZWw+PHRpdGxlPiR0aXRsZTwvdGl0bGU+PGxpbms+IiAuIGh0bWxlbnRpdGllcygkc2VsZikgLiAiPC9saW5rPjxkZXNjcmlwdGlvbj5BIHNpbXBsZSB0b3JyZW50IGZlZWQgYnkgdG9yci48L2Rlc2NyaXB0aW9uPlxuIjsNCiAgICBmb3JlYWNoICgkaXRlbXMgYXMgJGl0ZW0pIHsNCiAgICAgICAgaWYgKCRpdGVtWydsaW5rJ10pIHsNCiAgICAgICAgICAgICRyc3MgLj0gIjxpdGVtPjx0aXRsZT48IVtDREFUQVsiIC4gJGl0ZW1bJ3RpdGxlJ10gLiAiXV0+PC90aXRsZT48bGluaz4iIC4gaHRtbGVudGl0aWVzKCRpdGVtWydsaW5rJ10pIC4gIjwvbGluaz4iOw0KICAgICAgICAgICAgJHJzcyAuPSAiPGNvbW1lbnRzPjwhW0NEQVRBWyIgLiBodG1sZW50aXRpZXMoJGl0ZW1bJ3BhZ2UnXSkgLiAiXV0+PC9jb21tZW50cz48Y2F0ZWdvcnk+PCFbQ0RBVEFbIiAuICRpdGVtWydjYXRlZ29yeSddIC4gIl1dPjwvY2F0ZWdvcnk+PC9pdGVtPlxuIjsNCiAgICAgICAgfQ0KICAgIH0NCiAgICAkcnNzIC49ICI8L2NoYW5uZWw+XG48L3Jzcz4iOw0KDQogICAgJGxvZ2dlci0+aW5mbygiUlNTfCDdMYi1yOQuIHQYOiAiIC4gY291bnQoJGl0ZW1zKSk7DQogICAgJGxvZ2dlci0+ZGVidWcoJHJzcyk7DQoNCiAgICByZXR1cm4gJHJzczsNCn0NCg0KDQojIHR8dLi4XCByc3N8IAShXOQuDQpmdW5jdGlvbiByZXNwb25zZSgkZGF0YSkNCnsNCiAgICBoZWFkZXIoJ0NvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vcnNzK3htbDsgY2hhcnNldD11dGYtOCcpOw0KICAgIGVjaG8gJGRhdGE7DQp9DQoNCiMgdHx0uLhcICRYIFTcwHwgBKFc5C4NCmZ1bmN0aW9uIGVycm9yX3Jlc3BvbnNlKCRkYXRhKQ0Kew0KICAgIGhlYWRlcignQ29udGVudC1UeXBlOiB0ZXh0L3BsYWluOyBjaGFyc2V0PXV0Zi04Jyk7DQogICAgZWNobyAkZGF0YTsNCn0NCg0KDQojIKAMuCByc3MglK1EIJisXOQuDQpmdW5jdGlvbiBtYWtlX3JzcygpDQp7DQogICAgJGJvYXJkX3VybHMgPSBwYXJzZV9wYXJhbSgpOw0KDQogICAgJGNvbmZpcm1lZF91cmxzID0gdXBkYXRlX2RvbWFpbigkYm9hcmRfdXJscyk7ICAjIMRUeCDAvSCYrA0KDQogICAgJHRvcnJlbnRfaXRlbXMgPSBnZXRfaXRlbXMoJGNvbmZpcm1lZF91cmxzKTsNCg0KICAgICRyc3MgPSBidWlsZF9yc3MoJHRvcnJlbnRfaXRlbXMpOw0KDQogICAgbWFnbmV0X2NhY2hlX2NvbnRyb2woJ1dyaXRlJyk7ICAjIMj4NyCQ3CAUpGwgMF0NCg0KICAgIHJlc3BvbnNlKCRyc3MpOw0KfQ0KDQoNCiMgoAy4IAx8KC50b3JyZW50KUQg5LRc3FzkLg0KZnVuY3Rpb24gZG93bmxvYWRfdG9ycmVudCgkbGluaykNCnsNCiAgICBnbG9iYWwgJGxvZ2dlcjsNCg0KICAgICRsb2dnZXItPmRlYnVnKCJEb3dubG9hZGluZyB0b3JyZW50IGZpbGUgZnJvbSAkbGluayIpOw0KDQogICAgbGlzdCgkaHR0cF9jb2RlLCAkaGVhZGVyLCAkYm9keSkgPSBjdXJsX2ZldGNoKCRsaW5rKTsNCg0KICAgIGlmICgkaHR0cF9jb2RlICE9IDIwMCkgew0KICAgICAgICAkbG9nZ2VyLT5lcnJvcigiRXJyb3IuIERvd25sb2FkIHRvcnJlbnQgZmlsZSBmcm9tICRsaW5rIHJldHVybmVkIGh0dHBfY29kZSAkaHR0cF9jb2RlIik7DQogICAgICAgIHJldHVybjsNCiAgICB9DQoNCiAgICBpZiAocHJlZ19tYXRjaCgnL15Db250ZW50LURpc3Bvc2l0aW9uOi4rJC9taScsICRoZWFkZXIsICRtYXRjaCkpIHsNCiAgICAgICAgaGVhZGVyKCJDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL3gtYml0dG9ycmVudCIpOw0KICAgICAgICBoZWFkZXIodHJpbSgkbWF0Y2hbMF0pKTsNCiAgICAgICAgZWNobyAkYm9keTsNCiAgICB9DQp9DQoNCg0KIyD5mHTA0BwgoAy4IAx8IMFsfCA+RCDktFzcXOQuDQpmdW5jdGlvbiBkb19kb3dubG9hZCgkdXJsKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KDQogICAgJHJlcGxhY2VfcGF0dGVybnMgPSAkR0xPQkFMU1snQ09ORklHJ11bJ19kb3duX2xpbmtfcHJlcHJvY2VzcyddOw0KICAgIGxpc3QoJGh0dHBfY29kZSwgJGhlYWRlciwgJGh0bWwpID0gY3VybF9mZXRjaCgkdXJsKTsNCg0KICAgIGlmICgkaHR0cF9jb2RlICE9IDIwMCkgew0KICAgICAgICAkbG9nZ2VyLT5lcnJvcigiRXJyb3IuIEZldGNoIGZyb20gJHVybCByZXR1cm5lZCBodHRwX2NvZGUgJGh0dHBfY29kZSIpOw0KICAgICAgICAkbG9nZ2VyLT5lcnJvcigkaGVhZGVyKTsNCiAgICAgICAgcmV0dXJuOw0KICAgIH0NCg0KICAgICRodG1sID0gcHJlcHJvY2VzcygkaHRtbCwgJHJlcGxhY2VfcGF0dGVybnMpOyAgIyBodG1sILSpWCB8gHwg+KwgwL0NCiAgICAkcGF0dGVybiA9ICRHTE9CQUxTWydDT05GSUcnXVsnX2Rvd25fbGluayddOw0KDQogICAgaWYgKHByZWdfbWF0Y2goJHBhdHRlcm4sICRodG1sLCAkbWF0Y2gpKSB7DQogICAgICAgICRsb2dnZXItPmRlYnVnKCRtYXRjaCk7DQogICAgICAgICRsaW5rID0gdXJsX2pvaW4oJHVybCwgJG1hdGNoWzFdKTsNCiAgICAgICAgZG93bmxvYWRfdG9ycmVudCgkbGluayk7DQogICAgfQ0KfQ0KDQoNCmZ1bmN0aW9uIG1haW4oKQ0Kew0KICAgIGdsb2JhbCAkbG9nZ2VyOw0KDQogICAgIyCUrSAV9CCcJQ0KICAgICRsb2dnZXItPmluZm8oInRvcnIghAQ6ICIgLiBWRVJTSU9OKTsNCiAgICAkbG9nZ2VyLT5pbmZvKCLIXLQglK10IOS0VLXI5C4gSVA9IiAuICAkX1NFUlZFUlsnUkVNT1RFX0FERFInXSk7DQogICAgJGxvZ2dlci0+aW5mbygiUkVRVUVTVF9VUkk6ICIgLiAkX1NFUlZFUlsnUkVRVUVTVF9VUkknXSk7DQogICAgJGxvZ2dlci0+ZGVidWcoJF9TRVJWRVIpOw0KDQogICAgaWYgKGlzc2V0KCRfR0VUWydkJ10pKSB7DQogICAgICAgIGRvX2Rvd25sb2FkKGJhc2U2NF9kZWNvZGUoJF9HRVRbJ2QnXSkpOw0KICAgIH0gZWxzZSB7DQogICAgICAgIG1ha2VfcnNzKCk7DQogICAgICAgIHNlbGZfdXBkYXRlKCk7DQogICAgfQ0KfQ0KDQoNCmZ1bmN0aW9uIGdlbl9iYXNlNjQoKSB7DQogICAgJGxvY2FsX2Jhc2U2NCA9IGJhc2U2NF9lbmNvZGUoZmlsZV9nZXRfY29udGVudHMoX19GSUxFX18pKTsNCiAgICBwcmludCgkbG9jYWxfYmFzZTY0KTsNCn0NCg0KDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KIyMgTWFpbigpDQojIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIw0KaWYgKGlzc2V0KCRhcmdjKSAmJiAkYXJnYyA+IDEgJiYgJGFyZ3ZbMV0gPT0gJ2Jhc2U2NCcpIHsNCiAgICBnZW5fYmFzZTY0KCk7DQp9IGVsc2Ugew0KICAgIG1haW4oKTsNCn0NCg0K